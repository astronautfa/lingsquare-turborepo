import{a as g,b as y,c as C,d as s,e as f,f as E,i as h,j as v}from"./vidstack-57AWZY4T.js";import"./vidstack-U3MKAWKX.js";import"./vidstack-YHRZY7KJ.js";import{c}from"./vidstack-5LA5YANY.js";import{A as m,a as l,c as d}from"./vidstack-RMERH5DU.js";import{a as n,ma as p}from"./vidstack-YO4XO2QW.js";import"./vidstack-IGJ6WVY6.js";var w=class{name="google-cast";target;#e;get cast(){return f()}mediaType(){return"video"}canPlay(e){return d&&!l&&m(e)}async prompt(e){let t,o,r;try{t=await this.#r(e),this.#e||(this.#e=new cast.framework.RemotePlayer,new cast.framework.RemotePlayerController(this.#e)),o=e.player.createEvent("google-cast-prompt-open",{trigger:t}),e.player.dispatchEvent(o),this.#t(e,"connecting",o),await this.#a(n(e.$props.googleCast)),e.$state.remotePlaybackInfo.set({deviceName:E()?.getCastDevice().friendlyName}),s()&&this.#t(e,"connected",o)}catch(a){let i=a instanceof Error?a:this.#o((a+"").toUpperCase(),"Prompt failed.");throw r=e.player.createEvent("google-cast-prompt-error",{detail:i,trigger:o??t,cancelable:!0}),e.player.dispatch(r),this.#t(e,s()?"connected":"disconnected",r),i}finally{e.player.dispatch("google-cast-prompt-close",{trigger:r??o??t})}}async load(e){if(p)throw Error("[vidstack] can not load google cast provider server-side");if(!this.#e)throw Error("[vidstack] google cast player was not initialized");return new(await import("./vidstack-AMVXBFRH.js")).GoogleCastProvider(this.#e,e)}async#r(e){if(y())return;let t=e.player.createEvent("google-cast-load-start");e.player.dispatch(t),await c(g()),await customElements.whenDefined("google-cast-launcher");let o=e.player.createEvent("google-cast-loaded",{trigger:t});if(e.player.dispatch(o),!C())throw this.#o("CAST_NOT_AVAILABLE","Google Cast not available on this platform.");return o}async#a(e){this.#s(e);let t=await this.cast.requestSession();if(t)throw this.#o(t.toUpperCase(),v(t))}#s(e){this.cast?.setOptions({...h(),...e})}#t(e,t,o){let r={type:"google-cast",state:t};e.notify("remote-playback-change",r,o)}#o(e,t){let o=Error(t);return o.code=e,o}};export{w as GoogleCastLoader};
