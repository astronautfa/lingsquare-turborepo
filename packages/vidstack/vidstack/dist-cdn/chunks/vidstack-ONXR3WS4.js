import{b as c,e as m}from"./vidstack-5WSKX3LK.js";import{b as u}from"./vidstack-DHW3MMHQ.js";import{B as n,H as i,U as p,V as g,i as d,t as l}from"./vidstack-BQB2M2TQ.js";var a=class extends p{static props={src:null,alt:null,crossOrigin:null};static state=new g({img:null,src:null,alt:null,crossOrigin:null,loading:!0,error:null,hidden:!1});#t;onSetup(){this.#t=m(),this.#r(),this.#o(),this.#n(),this.#e()}onAttach(t){t.style.setProperty("pointer-events","none"),i(this.#d.bind(this)),i(this.#r.bind(this)),i(this.#o.bind(this)),i(this.#n.bind(this)),i(this.#e.bind(this));let{started:s}=this.#t.$state;this.setAttributes({"data-visible":()=>!s()&&!this.$state.hidden(),"data-loading":this.#h.bind(this),"data-error":this.#s.bind(this),"data-hidden":this.$state.hidden})}onConnect(t){i(this.#l.bind(this)),i(this.#c.bind(this))}#s(){let{error:t}=this.$state;return!d(t())}#l(){let{canLoadPoster:t,poster:s}=this.#t.$state;!t()&&s()&&u(s(),"preconnect")}#e(){let{src:t}=this.$props,{poster:s,nativeControls:e}=this.#t.$state;this.el&&n(this.el,"display",e()?"none":null),this.$state.hidden.set(this.#s()||!(t()||s())||e())}#h(){let{loading:t,hidden:s}=this.$state;return!s()&&t()}#d(){let t=this.$state.img();t&&(l(t,"load",this.#a.bind(this)),l(t,"error",this.#p.bind(this)),t.complete&&this.#a())}#i="";#r(){let{poster:t}=this.#t.$props,{canLoadPoster:s,providedPoster:e,inferredPoster:o}=this.#t.$state,r=this.$props.src()||"",h=r||t()||o();this.#i===e()&&e.set(r),this.$state.src.set(s()&&h.length?h:null),this.#i=r}#o(){let{src:t}=this.$props,{alt:s}=this.$state,{poster:e}=this.#t.$state;s.set(t()||e()?this.$props.alt():null)}#n(){let{crossOrigin:t}=this.$props,{crossOrigin:s}=this.$state,{crossOrigin:e,poster:o}=this.#t.$state,r=t()!==null?t():e();s.set(/ytimg\.com|vimeo/.test(o()||"")?null:r===!0?"anonymous":r)}#c(){let{loading:t,error:s}=this.$state,{canLoadPoster:e,poster:o}=this.#t.$state;t.set(e()&&!!o()),s.set(null)}#a(){let{loading:t,error:s}=this.$state;t.set(!1),s.set(null)}#p(t){let{loading:s,error:e}=this.$state;s.set(!1),e.set(t)}};var $=class extends c(HTMLElement,a){static tagName="media-poster";static attrs={crossOrigin:"crossorigin"};#t=document.createElement("img");onSetup(){this.$state.img.set(this.#t)}onConnect(){let{src:t,alt:s,crossOrigin:e}=this.$state;i(()=>{let{loading:o,hidden:r}=this.$state;this.#t.style.display=o()||r()?"none":""}),i(()=>{n(this.#t,"alt",s()),n(this.#t,"crossorigin",e()),n(this.#t,"src",t())}),this.#t.parentNode!==this&&this.prepend(this.#t)}};export{$ as a};
