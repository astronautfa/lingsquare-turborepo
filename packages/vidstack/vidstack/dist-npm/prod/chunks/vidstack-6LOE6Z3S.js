import{b as u}from"./vidstack-HDVJ2P4K.js";import{b as p}from"./vidstack-BQBKKLOB.js";import{F as h,L as i,U as d,V as c,i as l,x as n}from"./vidstack-XC7WIXLW.js";var g=class extends d{static props={src:null,alt:null,crossOrigin:null};static state=new c({img:null,src:null,alt:null,crossOrigin:null,loading:!0,error:null,hidden:!1});#t;onSetup(){this.#t=u(),this.#r(),this.#o(),this.#n(),this.#e()}onAttach(t){t.style.setProperty("pointer-events","none"),i(this.#d.bind(this)),i(this.#r.bind(this)),i(this.#o.bind(this)),i(this.#n.bind(this)),i(this.#e.bind(this));let{started:s}=this.#t.$state;this.setAttributes({"data-visible":()=>!s()&&!this.$state.hidden(),"data-loading":this.#h.bind(this),"data-error":this.#s.bind(this),"data-hidden":this.$state.hidden})}onConnect(t){i(this.#l.bind(this)),i(this.#c.bind(this))}#s(){let{error:t}=this.$state;return!l(t())}#l(){let{canLoadPoster:t,poster:s}=this.#t.$state;!t()&&s()&&p(s(),"preconnect")}#e(){let{src:t}=this.$props,{poster:s,nativeControls:e}=this.#t.$state;this.el&&h(this.el,"display",e()?"none":null),this.$state.hidden.set(this.#s()||!(t()||s())||e())}#h(){let{loading:t,hidden:s}=this.$state;return!s()&&t()}#d(){let t=this.$state.img();t&&(n(t,"load",this.#a.bind(this)),n(t,"error",this.#p.bind(this)),t.complete&&this.#a())}#i="";#r(){let{poster:t}=this.#t.$props,{canLoadPoster:s,providedPoster:e,inferredPoster:o}=this.#t.$state,r=this.$props.src()||"",a=r||t()||o();this.#i===e()&&e.set(r),this.$state.src.set(s()&&a.length?a:null),this.#i=r}#o(){let{src:t}=this.$props,{alt:s}=this.$state,{poster:e}=this.#t.$state;s.set(t()||e()?this.$props.alt():null)}#n(){let{crossOrigin:t}=this.$props,{crossOrigin:s}=this.$state,{crossOrigin:e,poster:o}=this.#t.$state,r=t()!==null?t():e();s.set(/ytimg\.com|vimeo/.test(o()||"")?null:r===!0?"anonymous":r)}#c(){let{loading:t,error:s}=this.$state,{canLoadPoster:e,poster:o}=this.#t.$state;t.set(e()&&!!o()),s.set(null)}#a(){let{loading:t,error:s}=this.$state;t.set(!1),s.set(null)}#p(t){let{loading:s,error:e}=this.$state;s.set(!1),e.set(t)}};export{g as a};
